(this.webpackJsonppractice=this.webpackJsonppractice||[]).push([[0],{58:function(e,t,a){},60:function(e,t,a){},62:function(e,t,a){},87:function(e,t,a){},88:function(e,t,a){},89:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){"use strict";a.r(t);var n=a(2),s=a(3),c=a(28),i=a.n(c),r=(a(58),a(59),a(60),a(27)),o=a(16),l=a(6),d=a.n(l),u=a(14),j=a(13),m=a(51),b=a(7),h=(a(62),a.p+"static/media/profile.d39ee9e2.png"),O=a(36),x=(O.a.initializeApp({apiKey:"AIzaSyCm06l81PepowAEpiXwNjGsyV5BaZOewQk",authDomain:"encryptchat-e5dda.firebaseapp.com",projectId:"encryptchat-e5dda",storageBucket:"encryptchat-e5dda.appspot.com",messagingSenderId:"112975287816",appId:"1:112975287816:web:ac19f1c27174776062e3bd",measurementId:"G-ZVPJSQZ498"}).firestore(),O.a.auth()),p=new O.a.auth.GoogleAuthProvider,f=a(9),v=a.n(f),g="SET_USER",w="REOMOVE_USER",y=function(e,t){switch(t.type){case g:return Object(u.a)(Object(u.a)({},e),{},{user:t.user});case w:return Object(u.a)(Object(u.a)({},e),{},{user:null});default:return e}},_=Object(s.createContext)(),M=function(){return Object(s.useContext)(_)},N=function(e){var t=e.reducer,a=e.initialState,c=e.children;return Object(n.jsx)(_.Provider,{value:Object(s.useReducer)(t,a),children:c})},S=function(){var e=M(),t=Object(b.a)(e,2);Object(m.a)(t[0]);var a=t[1],s=Object(o.g)(),c=function(){var e=Object(j.a)(d.a.mark((function e(){var t,n,c,i,r,o,l,j;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.signInWithPopup(p);case 3:return t=e.sent,n={displayname:t.user.displayName,email:t.user.email,avatarUrl:t.user.photoURL},a({type:g,user:n}),e.next=8,v.a.post("/adduser",Object(u.a)({},n));case 8:return e.next=10,v.a.post("/fetchconnections",{email:n.email});case 10:return c=e.sent,e.next=13,v.a.post("/fetchunseendmscount",{email:n.email});case 13:return i=e.sent,e.next=16,v.a.post("/fetchunseenemailscount",{email:n.email});case 16:for(r=e.sent,o=c.data.connections,l=0;l<o.length;l++)void 0==i.data.unseencount[o[l].email]?o[l].unseen=0:o[l].unseen=i.data.unseencount[o[l].email];for(j=0;j<o.length;j++)void 0==r.data.unseencount[o[j].email]?o[j].unseenemail=0:o[j].unseenemail=r.data.unseencount[o[j].email];o.sort((function(e,t){return e.unseen<t.unseen?1:-1})),o.sort((function(e,t){return e.unseenemail<t.unseenemail?1:-1})),s.push({pathname:"/dashboard",state:{user:n,connections:c.data.connections}}),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),console.log(e.t0.message);case 28:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)("div",{className:"Login",children:Object(n.jsxs)("div",{className:"Login__container",children:[Object(n.jsxs)("div",{className:"Login__header",children:[Object(n.jsx)("img",{src:h,alt:"Image"}),Object(n.jsx)("br",{}),Object(n.jsx)("h4",{children:"SecureEncrypt Chat"})]}),Object(n.jsx)("div",{className:"Login__footer",children:Object(n.jsx)("button",{class:"Login__button",type:"submit",onClick:c,children:"SIGN IN WITH GOOGLE ACCOUNT"})})]})})},C=(a(87),function(e){var t=M(),a=Object(b.a)(t,2),c=a[0].user,i=a[1],r=Object(o.g)(),l=Object(o.h)();Object(s.useEffect)((function(){l.state&&l.state.user?i({type:g,user:l.state.user}):(i({type:w}),r.push("/login"))}),[]);var m=function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/newconnections",{email:c.email});case 2:t=e.sent,r.push({pathname:"/connections",state:Object(u.a)(Object(u.a)({},l.state),{},{unreadconnections:t.data.unreadconnections})});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(j.a)(d.a.mark((function e(){var t,a,n,s,c,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.state.user.email,e.next=3,v.a.post("/fetchconnections",{email:t});case 3:return a=e.sent,e.next=6,v.a.post("/fetchunseendmscount",{email:t});case 6:return n=e.sent,e.next=9,v.a.post("/fetchunseenemailscount",{email:t});case 9:for(s=e.sent,c=a.data.connections,i=0;i<c.length;i++)void 0==n.data.unseencount[c[i].email]?c[i].unseen=0:c[i].unseen=n.data.unseencount[c[i].email];for(o=0;o<c.length;o++)void 0==s.data.unseencount[c[o].email]?c[o].unseenemail=0:c[o].unseenemail=s.data.unseencount[c[o].email];c.sort((function(e,t){return e.unseen<t.unseen?1:-1})),c.sort((function(e,t){return e.unseenemail<t.unseenemail?1:-1})),r.push({pathname:"/dashboard",state:{user:l.state.user,connections:c,allMessages:[],emailMessages:[]}});case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"PageTemplate__container",children:[Object(n.jsx)("div",{className:"PageTemplate__navbar",children:Object(n.jsx)("nav",{className:"navbar",children:Object(n.jsxs)("div",{className:"container-fluid",children:[Object(n.jsx)("a",{className:"navbar-brand",onClick:h,children:"SecureEncryptChat"}),Object(n.jsxs)("div",{className:"PageTemplate__navbar_icons",children:[Object(n.jsx)("i",{onClick:m,className:"fa fa-users"}),Object(n.jsx)("i",{onClick:function(){},className:"fa fa-cog"}),Object(n.jsx)("i",{onClick:function(){i({type:w}),localStorage.removeItem("user"),r.push("/login")},className:"fa fa-sign-out"})]})]})})}),Object(n.jsx)("div",{className:"PageTemplate__body",children:e.children}),Object(n.jsx)("div",{className:"PageTemplate__footer",children:Object(n.jsxs)("b",{children:["\u24d2 2020 - ",(new Date).getFullYear()," SECURE ENCRYPT CHAT, Inc. All rights reserved."]})})]})}),k=(a(88),a(26)),T=a.n(k),D=a(29),B=a.n(D),E=function(){var e=M(),t=Object(b.a)(e,2),a=t[0].user,c=(t[1],Object(o.g)()),i=Object(o.h)(),r=Object(s.useState)(i.state.connections),l=Object(b.a)(r,2),u=l[0],m=l[1],h=Object(s.useState)(-1),O=Object(b.a)(h,2),x=(O[0],O[1],Object(s.useState)("")),p=Object(b.a)(x,2),f=(p[0],p[1]);Object(s.useEffect)((function(){new B.a("11a8dd35181269e15a84",{cluster:"ap2"}).subscribe("users").bind("removeconnection",(function(e){var t=u.filter((function(t){return t.email!==e.email}));m(t)}))}),[u]);var g=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.push({pathname:"/directmessages",state:{user:a,connections:i.state.connections,allMessages:[]}});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.push({pathname:"/emails",state:{user:a,connections:i.state.connections,emailMessages:[]}});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(j.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/fetchalldirectmessages",{email:t,connectionemail:n});case 2:return s=e.sent,e.next=5,v.a.post("/directmessagesseen",{email:t,connectionemail:n});case 5:c.push({pathname:"/directmessages",state:{user:a,connections:i.state.connections,allMessages:s.data.allMessages}});case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),_=function(){var e=Object(j.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/fetchallemails",{email:t,connectionemail:n});case 2:return s=e.sent,e.next=5,v.a.post("/emailsseen",{email:t,connectionemail:n});case 5:c.push({pathname:"/emails",state:{user:a,connections:i.state.connections,emailMessages:s.data.emailMessages}});case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"Dashboard__container",children:[Object(n.jsxs)("div",{className:"Dashboard__directmessages Dashboard__row",children:[Object(n.jsxs)("div",{className:"row Dashboard__row_header",children:[Object(n.jsx)("div",{className:"col-10 text-center",children:Object(n.jsx)("h3",{children:"Direct Messages"})}),Object(n.jsx)("div",{className:"col Dashboard__row_icon",children:Object(n.jsx)("i",{onClick:g,className:"fa fa-external-link-square"})})]}),u.length>0?u.map((function(e,t){return Object(n.jsx)("div",{className:"Dashboard__DM_container",onClick:function(){f(e.email),y(a.email,e.email)},children:Object(n.jsxs)("div",{className:"row p-0 mt-2 m-0",children:[Object(n.jsx)("div",{className:"col-2",children:Object(n.jsx)("img",{src:e.avatarUrl,alt:e.displayname})}),Object(n.jsx)("div",{className:"col-8",children:Object(n.jsx)("h5",{children:e.email})}),Object(n.jsx)("div",{className:"col-2",children:Object(n.jsx)("p",{style:{float:"right"},children:e.unseen})})]})},t)})):Object(n.jsx)("div",{className:"div",style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:Object(n.jsx)("h4",{style:{textShadow:"1px 1px white",fontWeight:"bold"},children:"No Connections..."})})]}),Object(n.jsxs)("div",{className:"Dashboard__directmessages Dashboard__row",children:[Object(n.jsxs)("div",{className:"row Dashboard__row_header",children:[Object(n.jsx)("div",{className:"col-10 text-center",children:Object(n.jsx)("h3",{children:"Emails "})}),Object(n.jsx)("div",{className:"col Dashboard__row_icon",children:Object(n.jsx)("i",{onClick:w,className:"fa fa-external-link-square"})})]}),u.length>0?u.map((function(e,t){return Object(n.jsx)("div",{className:"Dashboard__DM_container",onClick:function(){f(e.email),_(a.email,e.email)},children:Object(n.jsxs)("div",{className:"row p-0 mt-2 m-0",children:[Object(n.jsx)("div",{className:"col-2",children:Object(n.jsx)("img",{src:e.avatarUrl,alt:e.displayname})}),Object(n.jsx)("div",{className:"col-8",children:Object(n.jsx)("h5",{children:e.email})}),Object(n.jsx)("div",{className:"col-2",children:Object(n.jsx)("p",{style:{float:"right"},children:e.unseenemail})})]})},t)})):Object(n.jsx)("div",{className:"div",style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:Object(n.jsx)("h4",{style:{textShadow:"1px 1px white",fontWeight:"bold"},children:"No Connections..."})})]})]})},I=(a(89),a(18)),P=a(30),R=function(e){var t=e.isShown,a=e.setIsShown,s=e.ModalTitle,c=e.ModalBody,i=function(){a({isShown:!1,ModalTitle:s,ModalBody:c})};return Object(n.jsxs)(I.a,{show:t,onHide:i,backdrop:"static",keyboard:!1,children:[Object(n.jsx)(I.a.Header,{closeButton:!0,style:{backgroundColor:"#5d001e",color:"white",textShadow:"2px 2px black"},children:Object(n.jsx)(I.a.Title,{children:s})}),Object(n.jsx)(I.a.Body,{style:{fontWeight:"bold"},children:c}),Object(n.jsx)(I.a.Footer,{children:Object(n.jsx)(P.a,{style:{backgroundColor:"#5d001e",color:"white",fontWeight:"bold"},onClick:i,children:"Close"})})]})},U=function(){var e=M(),t=Object(b.a)(e,2),a=t[0].user,c=(t[1],Object(o.h)()),i=Object(o.g)(),r=Object(s.useState)(""),l=Object(b.a)(r,2),u=l[0],m=l[1],h=Object(s.useState)({isShown:!1,ModalTitle:"",ModalBody:""}),O=Object(b.a)(h,2),x=O[0],p=O[1],f=Object(s.useState)(c.state.unreadconnections),g=Object(b.a)(f,2),w=g[0],y=g[1],_=function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.email!=u){e.next=3;break}return p({isShown:!0,ModalTitle:"LOL\ud83d\ude02",ModalBody:"You can't send a connection request to yourself..."}),e.abrupt("return");case 3:return e.next=5,v.a.post("/addconnection",{email:a.email,connectionemail:u});case 5:t=e.sent,p({isShown:!0,ModalTitle:t.data.ModalTitle,ModalBody:t.data.ModalBody});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.email!=u){e.next=3;break}return p({isShown:!0,ModalTitle:"LOL\ud83d\ude02",ModalBody:"You can't remove a connection to yourself..."}),e.abrupt("return");case 3:return e.next=5,v.a.post("/removeconnection",{email:a.email,connectionemail:u});case 5:t=e.sent,p({isShown:!0,ModalTitle:t.data.ModalTitle,ModalBody:t.data.ModalBody});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/acceptconnection",{email:a.email,connectionemail:t.email});case 2:e.sent,n=w.filter((function(e){return e.email!=t.email})),i.replace({pathname:"/connections",state:{user:a,unreadconnections:n}}),y(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/removeconnection",{email:a.email,connectionemail:t.email});case 2:e.sent,n=w.filter((function(e){return e.email!=t.email})),i.replace({pathname:"/connections",state:{user:a,unreadconnections:n}}),y(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"Connections",children:[Object(n.jsxs)("div",{className:"Connections__addconnections",children:[Object(n.jsx)("h1",{children:"Alter Connections"}),Object(n.jsxs)("div",{className:"Connections__addconnections_body",children:[Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("h3",{children:"Enter Email ID"})})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("input",{class:"form-control",type:"email",name:"email",value:u,onChange:function(e){m(e.target.value)}})})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("button",{type:"button",className:"btn",name:"addconnection",onClick:_,children:"Send Connection Request"})})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("button",{type:"button",className:"btn",name:"addconnection",onClick:N,children:"Remove Connection"})})})]})]}),Object(n.jsxs)("div",{className:"Connections__incomingconnections",children:[Object(n.jsx)("h1",{children:"Connections Requests"}),Object(n.jsx)("div",{className:"Connections__incomingconnections_body",children:w.map((function(e,t){return Object(n.jsxs)("div",{className:"Connections__unreadconnections",children:[Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col",children:[Object(n.jsx)("img",{src:e.avatarUrl,alt:e.displayname}),Object(n.jsx)("h5",{children:e.email})]})}),Object(n.jsxs)("div",{className:"row mt-3",children:[Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("button",{type:"button",className:"btn w-100 btn-success",name:"accept",onClick:function(){S(e)},children:"Accept"})}),Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("button",{type:"button",className:"btn w-100 btn-danger",name:"reject",onClick:function(){C(e)},children:"Reject"})})]})]},t)}))})]}),Object(n.jsx)(R,{isShown:x.isShown,setIsShown:p,ModalTitle:x.ModalTitle,ModalBody:x.ModalBody})]})},H=a(32),L=(a(91),a(25)),W=a.n(L),A=function(e){var t=e.isShown,a=e.setIsShown,c=e.message,i=e.setMessage,r=e.email,o=e.connectionemail,l=W()(new Date,"yyyy-mm-dd"),m=Object(s.useState)(""),h=Object(b.a)(m,2),O=h[0],x=h[1],p=Object(s.useState)(""),f=Object(b.a)(p,2),g=f[0],w=f[1],y=Object(s.useState)({isShown:!1,ModalTitle:"",ModalBody:""}),_=Object(b.a)(y,2),M=_[0],N=_[1],S=function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/delaydirectmessage",{text:c,senderemail:r,receiveremail:o,date:O,time:g});case 2:t=e.sent,N(Object(u.a)(Object(u.a)({},M),{},{isShown:!0,ModalTitle:t.data.ModalTitle,ModalBody:t.data.ModalBody})),"success"===t.data.status&&i(""),setTimeout((function(){N(Object(u.a)(Object(u.a)({},M),{},{isShown:!1})),C()}),2e3);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){a({isShown:!1,message:"",email:r,connectionemail:o}),x(""),w("")};return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(I.a,{show:t,onHide:C,backdrop:"static",children:[Object(n.jsx)(I.a.Header,{closeButton:!0,style:{backgroundColor:"#5d001e",color:"white",textShadow:"2px 2px black"},children:Object(n.jsx)(I.a.Title,{children:"Delayed Message"})}),Object(n.jsxs)(I.a.Body,{style:{fontWeight:"bold"},children:[Object(n.jsx)("h5",{style:{textShadow:"1px 1px #5d001e"},children:"Choose Date"}),Object(n.jsx)("input",{type:"date",name:"date",style:{backgroundColor:"#5d001e",color:"white"},class:"form-control mb-4",value:O,min:l,onChange:function(e){x(e.target.value)}}),Object(n.jsx)("h5",{style:{textShadow:"1px 1px #5d001e"},children:"Choose Time"}),Object(n.jsx)("input",{style:{backgroundColor:"#5d001e",color:"white"},class:"form-control",type:"time",name:"time",value:g,onChange:function(e){w(e.target.value)}})]}),Object(n.jsxs)(I.a.Footer,{children:[Object(n.jsx)(P.a,{style:{backgroundColor:"#5d001e",color:"white",fontWeight:"bold"},onClick:S,children:"Send Delayed Message"}),Object(n.jsx)(P.a,{style:{backgroundColor:"#5d001e",color:"white",fontWeight:"bold"},onClick:C,children:"Close"})]})]}),Object(n.jsx)(R,{isShown:M.isShown,setIsShown:N,ModalTitle:M.ModalTitle,ModalBody:M.ModalBody})]})},F=function(){var e=Object(o.h)(),t=(Object(o.g)(),e.state.user),a=Object(s.useState)(e.state.connections),c=Object(b.a)(a,2),i=c[0],r=c[1],l=Object(s.useState)(-1),m=Object(b.a)(l,2),h=m[0],O=m[1],x=Object(s.useState)(""),p=Object(b.a)(x,2),f=p[0],g=p[1],w=Object(s.useState)(e.state.allMessages),y=Object(b.a)(w,2),_=y[0],M=y[1],N=Object(s.useState)(""),S=Object(b.a)(N,2),C=S[0],k=S[1],D=Object(s.useState)({isShown:!1,ModalTitle:"",ModalBody:""}),E=Object(b.a)(D,2),I=E[0],P=E[1],U=Object(s.useState)({isShown:!1,message:f,email:t.email,connectionemail:C}),L=Object(b.a)(U,2),F=L[0],G=L[1];Object(s.useEffect)((function(){new B.a("11a8dd35181269e15a84",{cluster:"ap2"}).subscribe("users").bind("removeconnection",(function(e){var t=i.filter((function(t){return t.email!==e.email}));r(t)}))}),[i]),Object(s.useEffect)((function(){var e=new B.a("11a8dd35181269e15a84",{cluster:"ap2"}).subscribe("directmessages");return e.bind("newmessage",(function(e){t.email!=e.senderemail&&t.email!=e.receiveremail||C!=e.senderemail&&C!=e.receiveremail||M([].concat(Object(H.a)(_),[Object(u.a)({},e)]))})),e.bind("delayedmessages",(function(e){var a=e.delayedMessages.filter((function(e){return(t.email===e.senderemail||t.email===e.receiveremail)&&(C===e.senderemail||C===e.receiveremail)}));M([].concat(Object(H.a)(_),Object(H.a)(a)))})),function(){e.unbind_all(),e.unsubscribe(),J()}}),[_]);var q=function(){var e=Object(j.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/fetchalldirectmessages",{email:t,connectionemail:a});case 2:return n=e.sent,M(n.data.allMessages),e.next=6,v.a.post("/directmessagesseen",{email:t,connectionemail:a});case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Y=function(){var e=Object(j.a)(d.a.mark((function e(){var a,n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=C){e.next=3;break}return P({isShown:!0,ModalTitle:"Choose a Recepient...",ModalBody:"Please Choose a User to chat with..."}),e.abrupt("return");case 3:if(""!==f){e.next=6;break}return P({isShown:!0,ModalTitle:"Type a Message...",ModalBody:"Please type something to send..."}),e.abrupt("return");case 6:return a=W()(new Date,"yyyy-mm-dd"),n=W()(new Date,"HH:MM"),s={text:f,email:t.email,connectionemail:C,date:a,time:n},e.next=11,v.a.post("/senddirectmessage",s);case 11:g("");case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=document.getElementsByClassName("DirectMessages__chatarea")[0];e&&(e.scrollTop=e.scrollHeight)};return Object(n.jsxs)("div",{className:"DirectMessages",children:[Object(n.jsx)("i",{class:"fa fa-bars",onClick:function(){T()(".DirectMessages__sidebar").toggle(500)}}),Object(n.jsxs)("div",{className:"DirectMessages__container",children:[Object(n.jsx)("div",{className:"DirectMessages__sidebar w-100 ",children:i.map((function(e,a){return Object(n.jsx)("div",{id:"connection"+a,className:"DirectMessages__connections ",onClick:function(){-1!=h&&T()("#connection"+h).removeClass("DirectMessages__connections_active"),O(a),T()("#connection"+a).addClass("DirectMessages__connections_active"),k(e.email),q(t.email,e.email)},children:Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col",children:[Object(n.jsx)("img",{src:e.avatarUrl,alt:e.displayname}),Object(n.jsx)("h5",{children:e.email})]})})},a)}))}),Object(n.jsxs)("div",{className:"DirectMessages__chat w-100 ",children:[Object(n.jsx)("div",{className:"DirectMessages__chatarea",children:_.map((function(e,a){return Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col",children:[Object(n.jsx)("p",{className:"DirectMessages__message ".concat(e.senderemail==t.email?"sender":"receiver"),children:e.text}),e.senderemail==t.email?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("p",{className:"DirectMessages__time ".concat(e.senderemail==t.email?"sender":"receiver"),children:e.time}),Object(n.jsxs)("p",{className:"DirectMessages__date ".concat(e.senderemail==t.email?"sender":"receiver"),children:[e.date," \xa0\xa0"]})]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("p",{className:"DirectMessages__date ".concat(e.senderemail==t.email?"sender":"receiver"),children:[e.date," \xa0\xa0"]}),Object(n.jsx)("p",{className:"DirectMessages__time ".concat(e.senderemail==t.email?"sender":"receiver"),children:e.time})," "]})]})},a)}))}),Object(n.jsxs)("div",{className:"DirectMessages__inputarea",children:[Object(n.jsx)("input",{class:"form-control customform",type:"text",name:"message",value:f,onChange:function(e){g(e.target.value)},onKeyDown:function(e){13==e.keyCode&&Y()}}),Object(n.jsx)("i",{class:"fa fa-paper-plane",onClick:Y}),Object(n.jsx)("i",{class:"fa fa-clock-o",onClick:function(){""!=C?""!==f?G({isShown:!0,message:f,email:t.email,connectionemail:C}):P({isShown:!0,ModalTitle:"Type a Message...",ModalBody:"Please type something to send..."}):P({isShown:!0,ModalTitle:"Choose a Recepient...",ModalBody:"Please Choose a User to chat with..."})}})]})]})]}),Object(n.jsx)(R,{isShown:I.isShown,setIsShown:P,ModalTitle:I.ModalTitle,ModalBody:I.ModalBody}),Object(n.jsx)(A,{isShown:F.isShown,setIsShown:G,message:F.message,setMessage:g,email:F.email,connectionemail:F.connectionemail})]})},G=(a(92),function(e){var t=e.isShown,a=e.setIsShown,c=e.message,i=e.setMessage,r=e.subject,o=e.setSubject,l=e.email,m=e.connectionemail,h=W()(new Date,"yyyy-mm-dd"),O=Object(s.useState)(""),x=Object(b.a)(O,2),p=x[0],f=x[1],g=Object(s.useState)(""),w=Object(b.a)(g,2),y=w[0],_=w[1],M=Object(s.useState)({isShown:!1,ModalTitle:"",ModalBody:""}),N=Object(b.a)(M,2),S=N[0],C=N[1],k=function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/delayemail",{text:c,senderemail:l,receiveremail:m,subject:r,date:p,time:y});case 2:t=e.sent,C(Object(u.a)(Object(u.a)({},S),{},{isShown:!0,ModalTitle:t.data.ModalTitle,ModalBody:t.data.ModalBody})),"success"===t.data.status&&(i(""),o("")),setTimeout((function(){C(Object(u.a)(Object(u.a)({},S),{},{isShown:!1})),T()}),2e3);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){a({isShown:!1,message:"",email:l,subject:r,connectionemail:m}),f(""),_("")};return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(I.a,{show:t,onHide:T,backdrop:"static",children:[Object(n.jsx)(I.a.Header,{closeButton:!0,style:{backgroundColor:"#5d001e",color:"white",textShadow:"2px 2px black"},children:Object(n.jsx)(I.a.Title,{children:"Delayed Email"})}),Object(n.jsxs)(I.a.Body,{style:{fontWeight:"bold"},children:[Object(n.jsx)("h5",{style:{textShadow:"1px 1px #5d001e"},children:"Choose Date"}),Object(n.jsx)("input",{type:"date",name:"date",style:{backgroundColor:"#5d001e",color:"white"},class:"form-control mb-4",value:p,min:h,onChange:function(e){f(e.target.value)}}),Object(n.jsx)("h5",{style:{textShadow:"1px 1px #5d001e"},children:"Choose Time"}),Object(n.jsx)("input",{style:{backgroundColor:"#5d001e",color:"white"},class:"form-control",type:"time",name:"time",value:y,onChange:function(e){_(e.target.value)}})]}),Object(n.jsxs)(I.a.Footer,{children:[Object(n.jsx)(P.a,{style:{backgroundColor:"#5d001e",color:"white",fontWeight:"bold"},onClick:k,children:"Send Delayed Email"}),Object(n.jsx)(P.a,{style:{backgroundColor:"#5d001e",color:"white",fontWeight:"bold"},onClick:T,children:"Close"})]})]}),Object(n.jsx)(R,{isShown:S.isShown,setIsShown:C,ModalTitle:S.ModalTitle,ModalBody:S.ModalBody})]})}),q=function(){var e=Object(o.h)(),t=(Object(o.g)(),e.state.user),a=Object(s.useState)(e.state.connections),c=Object(b.a)(a,2),i=c[0],r=c[1],l=Object(s.useState)(-1),m=Object(b.a)(l,2),h=m[0],O=m[1],x=Object(s.useState)(""),p=Object(b.a)(x,2),f=p[0],g=p[1],w=Object(s.useState)(""),y=Object(b.a)(w,2),_=y[0],M=y[1],N=Object(s.useState)(""),S=Object(b.a)(N,2),C=S[0],k=S[1],D=Object(s.useState)(e.state.emailMessages),E=Object(b.a)(D,2),I=E[0],P=E[1],U=Object(s.useState)({isShown:!1,ModalTitle:"",ModalBody:""}),L=Object(b.a)(U,2),A=L[0],F=L[1],q=Object(s.useState)({isShown:!1,message:C,email:t.email,connectionemail:f,subject:_}),Y=Object(b.a)(q,2),J=Y[0],V=Y[1];Object(s.useEffect)((function(){new B.a("11a8dd35181269e15a84",{cluster:"ap2"}).subscribe("users").bind("removeconnection",(function(e){var t=i.filter((function(t){return t.email!==e.email}));r(t)}))}),[i]),Object(s.useEffect)((function(){var e=new B.a("11a8dd35181269e15a84",{cluster:"ap2"}).subscribe("emails");return e.bind("newemail",(function(e){t.email!=e.senderemail&&t.email!=e.receiveremail||f!=e.senderemail&&f!=e.receiveremail||P([].concat(Object(H.a)(I),[Object(u.a)({},e)]))})),e.bind("delayedemails",(function(e){var a=e.delayedEmails.filter((function(e){return(t.email===e.senderemail||t.email===e.receiveremail)&&(f===e.senderemail||f===e.receiveremail)}));P([].concat(Object(H.a)(I),Object(H.a)(a)))})),function(){e.unbind_all(),e.unsubscribe(),Q()}}),[I]);var Z=function(){var e=Object(j.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/fetchallemails",{email:t,connectionemail:a});case 2:return n=e.sent,P(n.data.emailMessages),e.next=6,v.a.post("/emailsseen",{email:t,connectionemail:a});case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),z=function(){var e=Object(j.a)(d.a.mark((function e(){var a,n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=f){e.next=3;break}return F({isShown:!0,ModalTitle:"Choose a Recepient...",ModalBody:"Please Choose a User to chat with..."}),e.abrupt("return");case 3:if(""!==C){e.next=6;break}return F({isShown:!0,ModalTitle:"Type a Message Body...",ModalBody:"Please type something to send..."}),e.abrupt("return");case 6:return a=W()(new Date,"yyyy-mm-dd"),n=W()(new Date,"HH:MM"),s={text:C,email:t.email,connectionemail:f,date:a,time:n,subject:_},e.next=11,v.a.post("/sendemail",s);case 11:k(""),M("");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=f){e.next=3;break}return F({isShown:!0,ModalTitle:"Choose a Recepient...",ModalBody:"Please Choose a User to chat with..."}),e.abrupt("return");case 3:if(""!==C){e.next=6;break}return F({isShown:!0,ModalTitle:"Type a Message...",ModalBody:"Please type something to send..."}),e.abrupt("return");case 6:V({isShown:!0,message:C,email:t.email,connectionemail:f,subject:_});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=document.getElementsByClassName("Emails__chatarea")[0];e&&(e.scrollTop=e.scrollHeight)};return Object(n.jsxs)("div",{className:"Emails",children:[Object(n.jsx)("i",{class:"fa fa-bars",onClick:function(){T()(".Emails__sidebar").toggle(500)}}),Object(n.jsxs)("div",{className:"Emails__container",children:[Object(n.jsx)("div",{className:"Emails__sidebar w-100 ",children:i.map((function(e,a){return Object(n.jsx)("div",{id:"connection"+a,className:"DirectMessages__connections ",onClick:function(){-1!=h&&T()("#connection"+h).removeClass("DirectMessages__connections_active"),O(a),T()("#connection"+a).addClass("DirectMessages__connections_active"),g(e.email),Z(t.email,e.email)},children:Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col",children:[Object(n.jsx)("img",{src:e.avatarUrl,alt:e.displayname}),Object(n.jsx)("h5",{children:e.email})]})})},a)}))}),Object(n.jsxs)("div",{className:"Emails__chat w-100 ",children:[Object(n.jsxs)("div",{className:"Emails__chatarea",children:[console.log(I),I.map((function(e,a){return Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col",children:[Object(n.jsxs)("p",{className:"DirectMessages__message ".concat(e.senderemail==t.email?"sender":"receiver"),children:["Subject:",Object(n.jsx)("br",{}),e.subject,Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),"Body:",Object(n.jsx)("br",{}),e.text]}),e.senderemail==t.email?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("p",{className:"DirectMessages__time ".concat(e.senderemail==t.email?"sender":"receiver"),children:e.time}),Object(n.jsxs)("p",{className:"DirectMessages__date ".concat(e.senderemail==t.email?"sender":"receiver"),children:[e.date," \xa0\xa0"]})]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("p",{className:"DirectMessages__date ".concat(e.senderemail==t.email?"sender":"receiver"),children:[e.date," \xa0\xa0"]}),Object(n.jsx)("p",{className:"DirectMessages__time ".concat(e.senderemail==t.email?"sender":"receiver"),children:e.time})," "]})]})},a)}))]}),Object(n.jsxs)("div",{className:"Emails__inputarea",children:[Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("input",{type:"email",name:"email",disabled:!0,value:f,onChange:function(e){g(e.target.value)},className:"form-control customform",placeholder:"Enter Recipient Email"})})}),Object(n.jsx)("div",{className:"row mt-3",children:Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("input",{type:"text",className:"form-control customform",placeholder:"Enter Subject",name:"subject",value:_,onChange:function(e){M(e.target.value)}})})}),Object(n.jsx)("div",{className:"row mt-3",children:Object(n.jsxs)("div",{className:"col",children:[Object(n.jsx)("textarea",{name:"message",value:C,onChange:function(e){k(e.target.value)},class:"form-control customform",placeholder:"Enter message to be sent...",rows:"3"}),Object(n.jsx)("i",{class:"fa fa-paper-plane",onClick:z}),Object(n.jsx)("i",{class:"fa fa-clock-o",onClick:K})]})})]})]})]}),Object(n.jsx)(R,{isShown:A.isShown,setIsShown:F,ModalTitle:A.ModalTitle,ModalBody:A.ModalBody}),Object(n.jsx)(G,{isShown:J.isShown,setIsShown:V,message:J.message,setMessage:k,subject:J.subject,setSubject:M,email:J.email,connectionemail:J.connectionemail})]})},Y=function(){return Object(n.jsx)("div",{children:Object(n.jsx)(r.a,{children:Object(n.jsxs)(o.d,{children:[Object(n.jsx)(o.b,{exact:!0,path:"/",children:Object(n.jsx)(o.a,{to:"/login"})}),Object(n.jsx)(o.b,{exact:!0,path:"/login",children:Object(n.jsx)(S,{})}),Object(n.jsx)(o.b,{exact:!0,path:"/dashboard",children:Object(n.jsx)(C,{children:Object(n.jsx)(E,{})})}),Object(n.jsx)(o.b,{exact:!0,path:"/connections",children:Object(n.jsx)(C,{children:Object(n.jsx)(U,{})})}),Object(n.jsx)(o.b,{exact:!0,path:"/directmessages",children:Object(n.jsx)(C,{children:Object(n.jsx)(F,{})})}),Object(n.jsx)(o.b,{exact:!0,path:"/emails",children:Object(n.jsx)(C,{children:Object(n.jsx)(q,{})})})]})})})};v.a.defaults.baseURL="/api";var J=function(){return Object(n.jsx)("div",{class:"App__container",children:Object(n.jsx)(Y,{})})};i.a.render(Object(n.jsx)(N,{initialState:{user:null},reducer:y,children:Object(n.jsx)(J,{})}),document.getElementById("root"))}},[[93,1,2]]]);
//# sourceMappingURL=main.bbdf844b.chunk.js.map